\documentclass[12pt]{article}
\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}
\setlength{\textwidth}{6.5in}
\setlength{\parindent}{0in}
\setlength{\parskip}{\baselineskip}

\usepackage{listings}
\usepackage{pdflscape}
\usepackage{lscape}
\usepackage{rotating}
\lstset{language=Matlab}
\usepackage{amsmath,amsfonts,amssymb}

\title{CS 206P HW4}

\begin{document}
Jingcheng Lu  42326170  

\hrulefill

\begin{enumerate}
\item problem 1
  \begin{enumerate}
  \item Matlab Code
  
  \begin{lstlisting}
  % problem 1
  result = ones(1,3);
  hb = hilb(5);
  invhb1 = invhilb(5);
  result(1,1) = cond(hb);
  condhb = cond(hb);
  muti1 = invhb1 * hb;
  n1 = norm(muti1 - eye(5));
  result(1,2) = norm(muti1 - eye(5));
  invhb2 = inv(hb);
  muti2 = invhb2 * hb;
  n2 = norm(muti2 - eye(5));
  result(1,3) = norm(muti2 - eye(5));
  \end{lstlisting}

  \item Result
  
  	% Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[htbp]
  \centering
  \caption{Problem 1 result}
    \begin{tabular}{rrr}
    \multicolumn{1}{l}{Condition Number} & \multicolumn{1}{l}{Norm(invhill)} & \multicolumn{1}{l}{Norm(inv)} \\
    476607.2502 & 3.30E-12 & 5.42E-12 \\
    \end{tabular}%
  \label{tab:addlabel}%
\end{table}%

  \item Analysis

   In this result, We can see that we use the invhilb function the norm is a bit smaller then when we use inv function.
   
  \end{enumerate}
  
\item Problem 2
  \begin{enumerate}
  \item Matlab Code
  \begin{lstlisting}
  % problem 2
  result = ones(30,4);
  for n=1.0:1.0:30.0
      result(n,1)=n;
      n=single(n); // for problem 3 just delete this line
      disp(n)
      hb = hilb(n);
      result(n,2) = cond(hb);

      invhb1 = invhilb(n);
      result(n,3) = norm(invhb1 * hb - eye(n));

      invhb2 = inv(hb);
      result(n,4) = norm(invhb2 * hb - eye(n));
      result(n,5) = norm(hb * invhb2 - eye(n));
  end
  \end{lstlisting}

  \item Result
  
	See Table 2.
    
  \item Analysis
  
  In this result, we can see that after N=7, the result norm when we use invhilb function grows much faster. However, when we use inv function, the error grow slowly with N, even when we transverse matrix and it's inverse, the grow speed still slower then when we use invhilb function.
  \end{enumerate}

\item Problem 3
  \begin{enumerate}
  \item Matlab code

  Almost same with problem 2, without transiting n to single precision

  \item Result
  
	See Table 3.
  \end{enumerate}

\item Problem 4
  \begin{enumerate}
  \item Matlab Code

  \begin{lstlisting}
  % problem 4
  result = ones(30,10);
  t = ones(1000,3);

  for n=1:1:30
      result(n,1)=n;
      imat = eye(n);
      for i=1:1:1000
          mat = rand(n);
          t(i,1) = cond(mat);
          invMat = inv(mat);
          t(i,2) = norm(mat * invMat - imat);
          t(i,3) = norm(invMat * mat - imat);
      end
      result(n,2:3:8)=mean(t);
      result(n,3:3:9)=min(t);
      result(n,4:3:10)=max(t);
  end
  \end{lstlisting}

  \item Result
  
	See Table 4.
  \end{enumerate}
  \newpage
    
  \begin{landscape}
  % Table generated by Excel2LaTeX from sheet 'Sheet1'
  \begin{table}[htbp]
    \centering
    \small
    \caption{Problem 2 result}
      \begin{tabular}{rrlrr}
      N     & \multicolumn{1}{l}{Condition Number} & Norm(invhilb(n)*hb-I) & \multicolumn{1}{l}{Norm(inv(hb)*hb-I)} & \multicolumn{1}{l}{Norm(hb*inv(hb)-I);} \\
      1     & 1     & \multicolumn{1}{r}{0} & 0     & 0 \\
      2     & 19.28147007 & \multicolumn{1}{r}{0} & 0     & 0 \\
      3     & 524.0567776 & \multicolumn{1}{r}{5.53E-15} & 5.16E-15 & 1.15E-14 \\
      4     & 15513.73874 & \multicolumn{1}{r}{5.68E-14} & 2.24E-13 & 7.73E-13 \\
      5     & 476607.2502 & \multicolumn{1}{r}{3.30E-12} & 5.42E-12 & 1.60E-11 \\
      6     & 14951058.64 & \multicolumn{1}{r}{2.91E-11} & 2.96E-10 & 6.24E-10 \\
      7     & 475367356.9 & \multicolumn{1}{r}{3.27961587} & 6.71E-09 & 3.13E-08 \\
      8     & 15257575567 & \multicolumn{1}{r}{79.94611195} & 1.39E-07 & 3.44E-07 \\
      9     & 4.93153E+11 & \multicolumn{1}{r}{1251.565225} & 3.40E-06 & 7.07E-05 \\
      10    & 1.6025E+13 & \multicolumn{1}{r}{146613.9995} & 9.54E-05 & 0.005255255 \\
      11    & 5.22021E+14 & \multicolumn{1}{r}{4360783.378} & 0.005498944 & 0.32605126 \\
      12    & 1.62E+16 & \multicolumn{1}{r}{155412217.1} & 0.147410377 & 9.668459327 \\
      13    & 4.79E+17 & \multicolumn{1}{r}{3756392498} & 11.35469582 & 3827.582711 \\
      14    & 2.55E+17 & \multicolumn{1}{r}{1.93573E+11} & 7.959829528 & 678.4249045 \\
      15    & 2.50E+17 & \multicolumn{1}{r}{4.75311E+12} & 5.558526585 & 2284.37268 \\
      16    & 4.89E+17 & \multicolumn{1}{r}{1.73523E+14} & 2.610041956 & 5395.664778 \\
      17    & 4.51E+17 & \multicolumn{1}{r}{3.35E+15} & 4.610668852 & 2876.456006 \\
      18    & 1.35E+18 & \multicolumn{1}{r}{1.26E+17} & 5.327320428 & 17831.50172 \\
      19    & 1.26E+18 & \multicolumn{1}{r}{2.93E+18} & 5.954997701 & 26840.33873 \\
      20    & 2.11E+18 & \multicolumn{1}{r}{6.37E+19} & 20.05690775 & 202354.1836 \\
      21    & 2.73E+18 & \multicolumn{1}{r}{6.75E+21} & 17.54948243 & 476625.5474 \\
      22    & 2.18E+18 & \multicolumn{1}{r}{1.55E+23} & 43.4508265 & 1474294.739 \\
      23    & 1.54E+18 & \multicolumn{1}{r}{5.75E+24} & 15.34482603 & 2356620.246 \\
      24    & 6.67E+18 & \multicolumn{1}{r}{8.98E+25} & 56.17224908 & 6871438.673 \\
      25    & 1.89E+19 & NaN   & 12.49822993 & 535508.8268 \\
      26    & 1.59E+18 & NaN   & 15.65737976 & 7666886.124 \\
      27    & 2.49E+18 & NaN   & 32.81955573 & 1360561.489 \\
      28    & 6.75E+18 & NaN   & 228.7018358 & 96520675.71 \\
      29    & 6.25E+19 & NaN   & 55.79752247 & 4652130.477 \\
      30    & 5.10E+18 & NaN   & 15.20744641 & 9593405.167 \\
      \end{tabular}%
    \label{tab:addlabel}%
  \end{table}%
    \end{landscape}
  \begin{landscape}
  % Table generated by Excel2LaTeX from sheet 'Sheet1'
  \begin{table}[htbp]
    \centering
    \small
    \caption{Problem 3 result}
      \begin{tabular}{rrrrr}
      N     & \multicolumn{1}{l}{Condition Number} & \multicolumn{1}{l}{Norm(invhilb(n)*hb-I)} & \multicolumn{1}{l}{Norm(inv(hb)*hb-I)} & \multicolumn{1}{l}{Norm(hb*inv(hb)-I);} \\
      1     & 1     & 0     & 0     & 0 \\
      2     & 19.28147007 & 0     & 0     & 0 \\
      3     & 524.0567776 & 5.53E-15 & 5.16E-15 & 1.15E-14 \\
      4     & 15513.73874 & 5.68E-14 & 2.24E-13 & 7.73E-13 \\
      5     & 476607.2502 & 3.30E-12 & 5.42E-12 & 1.60E-11 \\
      6     & 14951058.64 & 2.91E-11 & 2.96E-10 & 6.24E-10 \\
      7     & 475367356.9 & 4.87E-09 & 6.71E-09 & 3.13E-08 \\
      8     & 15257575567 & 1.79E-07 & 1.39E-07 & 3.44E-07 \\
      9     & 4.93153E+11 & 5.19E-06 & 3.40E-06 & 7.07E-05 \\
      10    & 1.6025E+13 & 0.000161297 & 9.54E-05 & 0.005255255 \\
      11    & 5.22021E+14 & 0.004715871 & 0.005498944 & 0.32605126 \\
      12    & 1.62E+16 & 0.125577718 & 0.147410377 & 9.668459327 \\
      13    & 4.79E+17 & 10.56769535 & 11.35469582 & 3827.582711 \\
      14    & 2.55E+17 & 284.7419042 & 7.959829528 & 678.4249045 \\
      15    & 2.50E+17 & 8678.094103 & 5.558526585 & 2284.37268 \\
      16    & 4.89E+17 & 169392.1204 & 2.610041956 & 5395.664778 \\
      17    & 4.51E+17 & 8.61E+06 & 4.610668852 & 2876.456006 \\
      18    & 1.35E+18 & 3.07E+08 & 5.327320428 & 17831.50172 \\
      19    & 1.26E+18 & 6.26E+09 & 5.954997701 & 26840.33873 \\
      20    & 2.11E+18 & 2.21E+11 & 20.05690775 & 202354.1836 \\
      21    & 2.73E+18 & 7.83E+12 & 17.54948243 & 476625.5474 \\
      22    & 2.18E+18 & 2.28E+14 & 43.4508265 & 1474294.739 \\
      23    & 1.54E+18 & 7.19E+15 & 15.34482603 & 2356620.246 \\
      24    & 6.67E+18 & 1.78E+17 & 56.17224908 & 6871438.673 \\
      25    & 1.89E+19 & 1.25E+19 & 12.49822993 & 535508.8268 \\
      26    & 1.59E+18 & 3.30E+20 & 15.65737976 & 7666886.124 \\
      27    & 2.49E+18 & 8.84E+21 & 32.81955573 & 1360561.489 \\
      28    & 6.75E+18 & 2.73E+23 & 228.7018358 & 96520675.71 \\
      29    & 6.25E+19 & 1.11E+25 & 55.79752247 & 4652130.477 \\
      30    & 5.10E+18 & 2.66E+26 & 15.20744641 & 9593405.167 \\
      \end{tabular}%
    \label{tab:addlabel}%
  \end{table}%
  
    \end{landscape}
  \begin{landscape}
% Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[htbp]
  \centering
  \small
  \tabcolsep=0.11cm
  \caption{Problem 4 result}
    \begin{tabular}{rrrrrrrrrr}
    N     & \multicolumn{1}{l}{MeanConditionNumber} & \multicolumn{1}{l}{Min.} & \multicolumn{1}{l}{Max.} & \multicolumn{1}{l}{MeanNm(M*inv-I)} & \multicolumn{1}{l}{Min.} & \multicolumn{1}{l}{Max.} & \multicolumn{1}{l}{MeanNm(inv*M-I)} & \multicolumn{1}{l}{Min.} & \multicolumn{1}{l}{Max.} \\
    1     & 1     & 1     & 1     & 1.73E-17 & 0     & 1.11E-16 & 1.73E-17 & 0     & 1.11E-16 \\
    2     & 39.77978269 & 1.128098963 & 15045.78253 & 2.64E-15 & 0     & 1.62E-12 & 1.11E-15 & 0     & 4.55E-13 \\
    3     & 208.3828163 & 2.61E+00 & 1.55E+05 & 8.67E-15 & 2.38E-17 & 6.30E-12 & 4.12E-15 & 5.13E-17 & 2.41E-12 \\
    4     & 57.85314957 & 3.41E+00 & 5.61E+03 & 2.88E-15 & 1.98E-16 & 1.68E-13 & 2.04E-15 & 1.69E-16 & 1.25E-13 \\
    5     & 7000.133272 & 5.51E+00 & 5.38E+06 & 2.46E-13 & 2.25E-16 & 2.00E-10 & 1.95E-13 & 2.39E-16 & 1.33E-10 \\
    6     & 278.4251097 & 6.97E+00 & 5.02E+04 & 1.33E-14 & 2.77E-16 & 3.27E-12 & 9.15E-15 & 3.97E-16 & 2.18E-12 \\
    7     & 208.7330519 & 8.63E+00 & 1.36E+04 & 1.36E-14 & 4.61E-16 & 9.21E-13 & 6.52E-15 & 4.46E-16 & 2.86E-13 \\
    8     & 552.5539039 & 1.11E+01 & 2.49E+05 & 3.24E-14 & 6.13E-16 & 1.28E-11 & 1.56E-14 & 4.03E-16 & 6.37E-12 \\
    9     & 414.0638461 & 1.60E+01 & 1.20E+05 & 2.01E-14 & 8.37E-16 & 3.83E-12 & 1.26E-14 & 6.34E-16 & 3.23E-12 \\
    10    & 329.740625 & 15.62337083 & 2.55E+04 & 1.97E-14 & 9.84E-16 & 1.63E-12 & 1.04E-14 & 7.98E-16 & 9.66E-13 \\
    11    & 350.837356 & 21.67726661 & 28069.84375 & 2.40E-14 & 1.45E-15 & 1.29E-12 & 1.11E-14 & 8.26E-16 & 7.26E-13 \\
    12    & 6.91E+02 & 24.07534521 & 280235.9236 & 5.25E-14 & 1.45E-15 & 2.57E-11 & 2.35E-14 & 1.02E-15 & 1.01E-11 \\
    13    & 4.68E+02 & 26.86175716 & 36039.06419 & 3.14E-14 & 2.07E-15 & 2.36E-12 & 1.55E-14 & 1.24E-15 & 1.24E-12 \\
    14    & 7.42E+02 & 28.406415 & 90326.43239 & 5.24E-14 & 2.27E-15 & 8.08E-12 & 2.31E-14 & 1.04E-15 & 2.35E-12 \\
    15    & 5.61E+02 & 25.69008064 & 48296.62039 & 3.83E-14 & 1.85E-15 & 4.61E-12 & 1.86E-14 & 1.36E-15 & 2.00E-12 \\
    16    & 1.21E+03 & 34.32014546 & 341271.1556 & 8.94E-14 & 2.88E-15 & 2.93E-11 & 3.88E-14 & 1.57E-15 & 9.93E-12 \\
    17    & 7.70E+02 & 3.44E+01 & 45928.53243 & 5.82E-14 & 2.95E-15 & 5.39E-12 & 2.54E-14 & 1.78E-15 & 1.86E-12 \\
    18    & 6.06E+02 & 3.85E+01 & 34452.2836 & 4.36E-14 & 3.28E-15 & 2.38E-12 & 1.99E-14 & 1.63E-15 & 9.93E-13 \\
    19    & 1.01E+03 & 4.86E+01 & 87520.92327 & 8.07E-14 & 4.01E-15 & 8.88E-12 & 3.31E-14 & 1.94E-15 & 2.99E-12 \\
    20    & 2.40E+03 & 5.01E+01 & 805597.7878 & 1.70E-13 & 4.36E-15 & 4.73E-11 & 8.11E-14 & 2.44E-15 & 3.05E-11 \\
    21    & 2.68E+03 & 5.58E+01 & 1576914.371 & 1.96E-13 & 5.17E-15 & 1.09E-10 & 1.02E-13 & 2.22E-15 & 6.66E-11 \\
    22    & 1.78E+03 & 6.19E+01 & 317751.5596 & 1.23E-13 & 5.84E-15 & 1.50E-11 & 5.63E-14 & 2.62E-15 & 1.05E-11 \\
    23    & 1.44E+03 & 5.24E+01 & 277883.9107 & 1.13E-13 & 5.71E-15 & 1.60E-11 & 4.78E-14 & 2.39E-15 & 9.10E-12 \\
    24    & 3.06E+03 & 7.25E+01 & 488186.7964 & 2.44E-13 & 6.06E-15 & 3.73E-11 & 9.57E-14 & 2.86E-15 & 1.45E-11 \\
    25    & 2.49E+03 & 5.99E+01 & 504718.6499 & 2.26E-13 & 6.21E-15 & 5.07E-11 & 8.62E-14 & 3.08E-15 & 1.49E-11 \\
    26    & 1.54E+03 & 6.25E+01 & 80026.17056 & 1.25E-13 & 6.52E-15 & 8.18E-12 & 5.37E-14 & 3.26E-15 & 4.34E-12 \\
    27    & 1.53E+03 & 8.76E+01 & 121137.8023 & 1.32E-13 & 9.03E-15 & 1.09E-11 & 5.07E-14 & 3.48E-15 & 3.47E-12 \\
    28    & 1.61E+03 & 8.83E+01 & 189418.669 & 1.44E-13 & 6.78E-15 & 2.27E-11 & 5.65E-14 & 3.26E-15 & 7.93E-12 \\
    29    & 2.08E+03 & 8.30E+01 & 223392.5077 & 1.82E-13 & 9.49E-15 & 1.65E-11 & 7.13E-14 & 3.56E-15 & 8.01E-12 \\
    30    & 1.84E+03 & 8.83E+01 & 337279.9273 & 1.70E-13 & 9.06E-15 & 3.22E-11 & 6.62E-14 & 3.10E-15 & 1.41E-11 \\
    \end{tabular}%
  \label{tab:addlabel}%
\end{table}%

  \end{landscape}

\end{enumerate}
\end{document}